<html>
<head>
    <title>Edit Contact</title>
    <# include "_authentication_user.espx" #>

    <script src="/js/commonResource.js"></script>

    <style type="text/css">
        .marginBottom10 {
            margin-bottom: 10px;
        }

        .customInputForAddress {
            margin-bottom: 10px;
        }

        .customNavBar {
            border-radius: 0px;
            margin-bottom: 0px;
        }

        .elementActive {

            background: #008AD5;
            color: #fff;
        }

        .autoComplete {
            z-index: 100;
            position: absolute;
            background: #fff;
            width: 100%;
            border: solid;
            border-width: 1;
            border-radius: 6px;
            border-color: #BDC3C7;
        }
    </style>

    <script type="text/javascript">
        function onAccountClick(event, name, id) {

            // $(event.target).removeClass("elementActive");
            $("#dummy-account-id-input").val(id);
            $("#account-auto-complete").val(name);
            $("#account-auto-complete-div").css("display", "none");
        }

        function onAccountAutoCompleteChange(event) {

           var search = $('#account-auto-complete').val();

           autoCompleteChanged(search, "account-auto-complete-div", "/accounts/_account_auto_complete_data", event.keyCode);

        }

        $(document).ready(function() {

            if("<#[url.id]#>" != "") {

                /* set selected contact and client if edit view*/

                $.get("_get_contact_account_by_id?id=" + "<#[url.id]#>", function(data, status) {

                    data = data.trim();
                    $('#account-auto-complete').val(data);

                });
            }

        });

    </script>

</head>

<body>

<div>
    <# include "easeCRMHeader.espx"; #>
</div>

<# apply  easeCRMContacts.<#[url.id]#> as "easecrmcontactobj"; #>

<div style="width: 800px;margin: 0 auto">
<h3>Edit Contact</h3>

<# start list for easeCRMIndustries;
    sort by name;
    save to industry.options;
#>

<# start row #>
    <option value="<# uuid #>" <# if("<# [easecrmcontactobj.industry]#>"=="<# uuid#>" ) {print "selected='selected'";} #> ><# name as html #></option>
<# end row #>
<# end list #>



<# start list for easeCRMSources;
    sort by name;
    save to source.options;
#>

<# start row #>
    <option value="<# uuid #>" <# if("<# [easecrmcontactobj.source]#>"=="<# uuid#>" ) {print "selected='selected'";} #> ><# name as html #></option>
<# end row #>
<# end list #>


<# start list for easeusers;
    sort by fname;
    save to assignedTo.options;
#>

<# start row #>
    <option value="<# uuid #>" <# if("<# [easecrmcontactobj.assignedto]#>"=="<# uuid#>" ) {print "selected='selected'";} #> ><# fname as html #> <# lname as html #></option>
<# end row #>
<# end list #>


<# start list for easetagsentities;
    relate easetagsentities.tagid to easetags.uuid;
    include when entityid=="<# [url.id] #>" and moduleid=="1";
    save to tags.value;
#>

<# start row #>
    <#easetags.name#> ,


<# end row #>
<# end list #>


<#
    if("<# [url.redirectUrl]#>" == "2"){
        set redirectVal to "/contacts/details?id=<# [url.id]#>";
    }else{
        set redirectVal to "/contacts";
    }
#>




    <form method="POST" action="_edit_contact?id=<#[url.id]#>&redirectUrl=<# [redirectVal]#>" style="margin-bottom: 0px">
    <div class="row">
        <div class="form-group col-lg-6">
            <label class="control-label">First Name:</label>

            <div>
                <input type="text" class="form-control  " required placeholder="First Name" name="fname"
                value="<#[easecrmcontactobj.fname]#>"/>
            </div>
        </div>

        <div class="form-group col-lg-6">
            <label class=" control-label">Last Name: </label>

            <div class="">
                <input type="text" class="form-control  " placeholder="Last Name" required name="lname"
                value="<#[easecrmcontactobj.lname]#>"/>
            </div>
        </div>

    </div>

    <div class="row">

        <div class="form-group col-lg-6">
            <label class=" control-label">Designation: </label>

            <div class="">
                <input type="text" class="form-control" placeholder="Designation" name="designation"
                value="<#[easecrmcontactobj.designation]#>" />
            </div>
        </div>

         <div class="form-group col-lg-6">
            <label class=" control-label">Account: </label>


            <div class="">
                <input id="account-auto-complete" onkeyup="onAccountAutoCompleteChange(event)" type="text" class="form-control" autocomplete="off" placeholder="Select Account" required />

                <input id="dummy-account-id-input"  type="hidden"  required name="account"
                value="<#[easecrmcontactobj.account]#>"/>

            </div>

            <div id="account-auto-complete-div"
                 class="autoComplete" style="width: 384px;border-top: 0;display:none;">
            </div>
        </div>

    </div>

    <div class="row">
        <div class="form-group col-lg-4">
            <label class=" control-label"> Work Email: </label>

            <div class="">
                <input type="text" class="form-control  " placeholder="Work Email" required name="workemail"
                value="<#[easecrmcontactobj.workemail]#>"/>
            </div>
        </div>

        <div class="form-group col-lg-4">
            <label class="control-label">Home Email: </label>

            <div class="">
                <input type="text" class="form-control  " placeholder="Home Email" name="homeemail"
                value="<#[easecrmcontactobj.homeemail]#>"/>
            </div>
        </div>

        <div class="form-group col-lg-4">
            <label class=" control-label">Personal Email: </label>

            <div class="">
                <input type="text" class="form-control  " placeholder="Personal Email" name="personalemail"
                value="<#[easecrmcontactobj.personalemail]#>"/>
            </div>
        </div>

    </div>

    <div class="row ">
        <div class="form-group col-lg-4">
            <label class=" control-label">Work Phone: </label>

            <div class="">
                <input type="tel" class="form-control " placeholder="Work Phone" required name="workphone"
                value="<#[easecrmcontactobj.workphone]#>"/>
            </div>
        </div>

        <div class="form-group col-lg-4">
            <label class=" control-label">Home Phone: </label>

            <div class="">
                <input type="tel" class="form-control " placeholder="Home Phone" name="homephone"
                value="<#[easecrmcontactobj.homephone]#>"/>
            </div>
        </div>

        <div class="form-group col-lg-4">
            <label class=" control-label">Personal Phone: </label>

            <div class="">
                <input type="tel" class="form-control " placeholder="Personal Phone" name="personalphone"
                value="<#[easecrmcontactobj.personalphone]#>"/>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="form-group">
            <label class=" col-lg-12 control-label">Address: </label>

            <div>
                <div class="col-lg-6">
                    <input type="text" class="form-control marginBottom10" placeholder="Street1" name="street1"
                    value="<#[easecrmcontactobj.street1]#>"/>
                </div>
                <div class="col-lg-6">
                    <input type="text" class="form-control marginBottom10 " placeholder="Street2" name="street2"
                    value="<#[easecrmcontactobj.street2]#>"/>
                </div>


            </div>
            <div>
                <div class="col-lg-3">
                    <input type="text" class="form-control marginBottom10 " placeholder="Area" name="area"
                    value="<#[easecrmcontactobj.area]#>" />
                </div>
                <div class="col-lg-3">
                    <input type="text" class="form-control marginBottom10 " placeholder="City" name="city"
                    value="<#[easecrmcontactobj.city]#>"/>
                </div>
                <div class="col-lg-3">
                    <input type="text" class="form-control marginBottom10 " placeholder="State" name="state"
                    value="<#[easecrmcontactobj.state]#>"/>
                </div>
                <div class="col-lg-3">
                    <input type="text" class="form-control marginBottom10 " placeholder="Zip" name="zip"
                    value="<# [easecrmcontactobj.zip]#>" />
                </div>


            </div>
        </div>


    </div>

    <div class="row">
        <div class="form-group col-lg-6">
            <label class="  control-label">Territory: </label>

            <div class="">
                <select class="form-control marginBottom10" name="territory" >
                    <option value="" >Select</option>
                    <option value="East" <# if("<# [easecrmcontactobj.territory]#>"=="East" ) {print "selected='selected'";} #>>East</option>
                    <option value="West" <# if("<# [easecrmcontactobj.territory]#>"=="West" ) {print "selected='selected'";} #>>West</option>
                    <option value="North" <# if("<# [easecrmcontactobj.territory]#>"=="North" ) {print "selected='selected'";} #>>North</option>
                    <option value="South" <# if("<# [easecrmcontactobj.territory]#>"=="South" ) {print "selected='selected'";} #>>South</option>
                    <option value="Central" <# if("<# [easecrmcontactobj.territory]#>"=="central" ) {print "selected='selected'";} #>>Central</option>
                </select>
            </div>
        </div>

            <div class="form-group col-lg-6">
                <label class=" control-label">Industry: </label>

                <div class="">
                    <select class="form-control marginBottom10" name="industry" >
                        <option value="" >Select</option>
                        <#[industry.options]#>
                    </select>
                </div>
            </div>

        </div>

        <div class="row">

            <div class="form-group col-lg-6">
                <label class=" control-label">Source: </label>

                <div class="">
                    <select class="form-control marginBottom10" name="source" >
                        <option value="" >Select</option>
                        <#[source.options]#>
                    </select>
                </div>
            </div>

            <div class="form-group col-lg-6">
                <label class=" control-label">Assigned To: </label>

                <div >
                    <select class="form-control marginBottom10" id="assignedTo" name="assignedto" required >
                        <option value="" >Select</option>
                        <#[assignedTo.options]#>
                    </select>

                </div>
            </div>

        </div>

        <div class="form-group col-lg-12">
            <label class=" control-label">Tags: </label>

            <div style="height: 45px">
                 <input id="tagsinput" class="tagsinput"  style="display: none;" name="tags" value="<# [tags.value]#>"/>
            </div>
        </div>



        <div class="row demo-row ">


            <div class="col-lg-4">
                <input type="submit" class="btn btn-block btn-lg btn-primary"  value="Update" />
            </div>

           </div>

    </div>


    </form>
</div>



</body>
</html>